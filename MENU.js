/*******************************************************
 *  üì® SENDER POSTMAN ‚Äî MENU
 *  üìÖ –í–µ—Ä—Å–∏—è: 2025-11 (–æ–±–Ω–æ–≤–ª–µ–Ω–æ ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω –ø—É–Ω–∫—Ç —Å—Å—ã–ª–æ–∫)
 *******************************************************/

/*
1) onOpen()
   ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç –º–µ–Ω—é –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Google Sheets
   ‚Äî –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Ñ–∞–π–ª–∞
*/
function onOpen() {
  const ui = SpreadsheetApp.getUi();
  const menu = ui.createMenu('üì® Sender Postman');

  /*
  2) –î–µ–π—Å—Ç–≤–∏—è –¥–ª—è –æ—Ç—á–µ—Ç–æ–≤ Hogan
     ‚Äî –∑–∞–ø—É—Å–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏
     ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑ –æ—Ç–ø—Ä–∞–≤–∫–∏
  */
  menu.addItem('üöÄ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –æ—Ç—á—ë—Ç—ã', 'senderPostmanRun');
  menu.addItem('üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ–≤—ã–µ –æ—Ç—á—ë—Ç—ã (–±–µ–∑ –æ—Ç–ø—Ä–∞–≤–∫–∏)', 'senderPostmanCheck');

  menu.addSeparator();

  /*
  3) –î–µ–π—Å—Ç–≤–∏–µ –¥–ª—è CSV –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π
     ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö –ø–∏—Å–µ–º —Å–æ —Å—Å—ã–ª–∫–∞–º–∏ (–ª–æ–≥–∏–Ω—ã/–ø–∞—Ä–æ–ª–∏)
     ‚Äî –ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∏—á–µ–≥–æ, —Ç–æ–ª—å–∫–æ –ø–æ–ª—É—á–∞–µ—Ç –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç
  */
  menu.addItem('üîó –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ–≤—ã–µ —Å—Å—ã–ª–∫–∏ (CSV)', 'senderInviteCheck');

  menu.addSeparator();

  /*
  4) –û—Ç–∫—Ä—ã—Ç–∏–µ –ª–æ–≥–∞ Postman
     ‚Äî –ª–æ–≥ –æ—Ç—á—ë—Ç–æ–≤
     ‚Äî –ª–æ–≥ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π –æ—Ç–¥–µ–ª—å–Ω—ã–π
  */
  menu.addItem('üìä –û—Ç–∫—Ä—ã—Ç—å –ª–æ–≥ SENDER', 'openSenderLog');

  /*
  5) –§–∏–Ω–∞–ª ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–µ–Ω—é –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
  */
  menu.addToUi();
}

/*
6) senderInviteCheck()
   ‚Äî –æ–±—ë—Ä—Ç–∫–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ CSV
   ‚Äî –Ω–µ –º–µ–Ω—è–µ—Ç Postman
   ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫ "menu-check"
*/
function senderInviteCheck() {
  senderInvite_('menu-check');
}

/*
7) openSenderLog()
   ‚Äî –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ª–∏—Å—Ç sender-log
   ‚Äî –µ—Å–ª–∏ –µ–≥–æ –µ—â—ë –Ω–µ—Ç ‚Äî —Å–æ–æ–±—â–∞–µ—Ç
*/
function openSenderLog() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const sh = ss.getSheetByName('sender-log');
  const ui = SpreadsheetApp.getUi();

  if (sh) {
    ss.setActiveSheet(sh);
    ui.alert('üìä –õ–æ–≥ SENDER –æ—Ç–∫—Ä—ã—Ç.');
  } else {
    ui.alert('‚ö†Ô∏è –õ–∏—Å—Ç "sender-log" –µ—â—ë –Ω–µ —Å–æ–∑–¥–∞–Ω.');
  }
}